AY 2 â€” Calls as First-Class Data Objects

Base URL:

http://localhost:3000/api/calls

1ï¸âƒ£ Create a call (POST /api/calls)
ğŸ“Œ Curl
curl -X POST http://localhost:3000/api/calls \
  -H "Content-Type: application/json" \
  -d '{
    "phone": "+919999999999",
    "direction": "outbound"
  }'

âœ… Expected response
{
  "id": 1,
  "phone": "+919999999999",
  "direction": "outbound",
  "status": "PENDING",
  "retries": 0,
  "created_at": "...",
  "next_action_at": "..."
}

2ï¸âƒ£ Fetch all calls (GET /api/calls)
ğŸ“Œ Curl
curl http://localhost:3000/api/calls

âœ… Expected response
[
  {
    "id": 1,
    "phone": "+919999999999",
    "direction": "outbound",
    "status": "PENDING"
  }
]

3ï¸âƒ£ Update call state (PATCH /api/calls/:id)
ğŸ“Œ Curl
curl -X PATCH http://localhost:3000/api/calls/1 \
  -H "Content-Type: application/json" \
  -d '{
    "status": "IN_PROGRESS"
  }'

âœ… Expected response
{
  "id": 1,
  "status": "IN_PROGRESS"
}

4ï¸âƒ£ Complete the call
curl -X PATCH http://localhost:3000/api/calls/1 \
  -H "Content-Type: application/json" \
  -d '{
    "status": "COMPLETED",
    "outcome": "test_completed"
  }'

âœ… Expected response
{
  "status": "COMPLETED",
  "outcome": "test_completed"
}

âŒ Try illegal update (should fail)
curl -X PATCH http://localhost:3000/api/calls/1 \
  -H "Content-Type: application/json" \
  -d '{
    "status": "PENDING"
  }'

âœ… Expected
{
  "error": "Cannot change status of a completed call"
}

âœ… DAY 2 SUCCESS CRITERIA (checklist)

âœ” Create call
âœ” Fetch calls
âœ” Update lifecycle
âœ” Block invalid mutation
âœ” No scheduler
âœ” No AI

ğŸ‘‰ If all curls work, Day 2 is DONE.